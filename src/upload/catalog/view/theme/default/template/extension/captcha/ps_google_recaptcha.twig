<fieldset>
  <legend>{{ text_captcha }}</legend>
  <div class="form-group required">
    <label class="{% if route|slice(0, 9) != 'checkout/' %}col-sm-2 {% endif %}control-label">{% if key_type == 'v2_checkbox' %}{{ entry_challange_captcha }}{% else %}{{ entry_score_based_captcha }}{% endif %}</label>
    {% if route|slice(0, 9) != 'checkout/' %}<div class="col-sm-10">{% endif %}
			{% if key_type == 'v2_checkbox' %}
				<div id="{% if route|slice(0, 9) == 'checkout/' %}input-payment-captcha{% else %}g-recaptcha-{{ widget_counter }}{% endif %}" data-sitekey="{{ site_key }}"></div>
				<script data-widget-id="{{ widget_counter }}">
					var recaptcha_form{{ widget_counter }} = document.currentScript ? document.currentScript.closest('form') : null;
					var recaptcha_widget{{ widget_counter }};
					var recaptcha_widget_obj{{ widget_counter }} = {% if route|slice(0, 9) == 'checkout/' %}document.querySelector('#input-payment-captcha');{% else %}document.querySelector('#g-recaptcha-{{ widget_counter }}');{% endif %}

					var onloadCallback{{ widget_counter }} = function () {
						recaptcha_widget{{ widget_counter }} = grecaptcha.render(recaptcha_widget_obj{{ widget_counter }}, {
							'sitekey': '{{ site_key }}',
							'theme': '{{ badge_theme }}',
							'size': '{{ badge_size }}'
						});
					};

					var resetRecaptcha{{ widget_counter }} = function () {
						if (window.grecaptcha && typeof grecaptcha.reset === 'function') {
							grecaptcha.reset(recaptcha_widget{{ widget_counter }});
						}
					};

					if (recaptcha_form{{ widget_counter }}) {
						recaptcha_form{{ widget_counter }}.addEventListener('submit', function () {
							setTimeout(resetRecaptcha{{ widget_counter }}, 1000);
						});
					}
				</script>
				<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback{{ widget_counter }}&render=explicit&badge={{ badge_position }}" async defer></script>
			{% endif %}
			{% if error_captcha %}<div class="text-danger">{{ error_captcha }}</div>{% endif %}
			{% if route|slice(0, 9) != 'checkout/' %}</div>{% endif %}
	</div>
</fieldset>
